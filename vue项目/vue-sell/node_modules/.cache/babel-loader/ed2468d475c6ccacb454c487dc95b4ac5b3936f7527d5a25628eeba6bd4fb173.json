{"ast":null,"code":"import \"core-js/modules/es.array.for-each.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport { getGoods } from '@/api';\nimport SupportIcon from '@/components/support-icon/Support-icon.vue';\nimport BScroll from '@better-scroll/core';\nimport Cart from '@/components/cart/Cart.vue';\nexport default {\n  components: {\n    SupportIcon: SupportIcon,\n    Cart: Cart\n  },\n  data: function data() {\n    return {\n      goods: [],\n      currentIndex: 0,\n      foodList: [],\n      //各菜系的食物dom结构\n      foodBScroll: [],\n      scrollY: 0,\n      foodHeight: [],\n      cartCount: []\n    };\n  },\n  created: function created() {\n    var _this = this;\n    // 获取商品数据\n    getGoods().then(function (res) {\n      console.log(res);\n      _this.goods = res;\n      _this.$nextTick(function () {\n        // $nextTick里面的回调会在页面加载完毕之后才执行\n        _this.betterScroll();\n        _this.getFoodHeight();\n        _this.goods.forEach(function (item, index) {\n          console.log(item, index);\n        });\n      });\n    });\n  },\n  methods: {\n    betterScroll: function betterScroll() {\n      var _this2 = this;\n      // 获取到menu-wrapper的dom结构\n      new BScroll(this.$refs.menuWrapper, {\n        click: true\n      });\n      this.foodBScroll = new BScroll(this.$refs.foodsWrapper, {\n        click: true,\n        scroll: true,\n        probeType: 3\n      });\n      this.foodList = this.$refs.foodList;\n      this.foodBScroll.on('scroll', function (pos) {\n        _this2.scrollY = Math.round(Math.abs(pos.y));\n      });\n    },\n    selectMenu: function selectMenu(i) {\n      // console.log(i);\n      this.currentIndex = i;\n      this.foodBScroll.scrollToElement(this.foodList[i], 500);\n    },\n    selectFood: function selectFood(i, y) {\n      console.log(i, y);\n    },\n    getFoodHeight: function getFoodHeight() {\n      var _this3 = this;\n      var height = 0;\n      this.foodHeight.push(height);\n      this.foodList.forEach(function (foodheight) {\n        height += foodheight.clientHeight;\n        _this3.foodHeight.push(height);\n      });\n    }\n  }\n  // computed:{\n  //   computeHeight(){\n  //     const \n  //   }\n  // }\n};","map":{"version":3,"names":["getGoods","SupportIcon","BScroll","Cart","components","data","goods","currentIndex","foodList","foodBScroll","scrollY","foodHeight","cartCount","created","_this","then","res","console","log","$nextTick","betterScroll","getFoodHeight","forEach","item","index","methods","_this2","$refs","menuWrapper","click","foodsWrapper","scroll","probeType","on","pos","Math","round","abs","y","selectMenu","i","scrollToElement","selectFood","_this3","height","push","foodheight","clientHeight"],"sources":["C:\\Users\\方鹏\\Desktop\\codingSpace\\vue项目\\vue-sell\\src\\views\\goods\\index.vue"],"sourcesContent":["<template>\n  <div class=\"goods\">\n    <div class=\"goods-content\">\n      <div class=\"menu-wrapper\" ref=\"menuWrapper\">\n        <ul>\n          <li \n            class=\"menu-item\" \n            :class=\"{'current' : currentIndex === index}\"\n            v-for=\"(item, index) in goods\" \n            :key=\"index\"\n            @click=\"selectMenu(index)\"\n          >\n            <span class=\"text\">\n              <SupportIcon size=\"3\" :type=\"item.type\" v-if=\"item.type >= 0\"/>\n              {{item.name}}\n            </span>\n          </li>\n        </ul>\n      </div>  \n      <div class=\"foods-wrapper\" ref=\"foodsWrapper\">\n        <ul>\n          <!-- 一个菜系 -->\n          <li class=\"food-list\" v-for=\"(item,index1) in goods\" :key=\"index1\" ref=\"foodList\">\n            <h1 class=\"title\">{{ item.name }}</h1>\n            <!-- 一道一道菜 -->\n            <ul>\n              <li class=\"food-item\"  v-for=\"(food,index2) in item.foods\" :key=\"index2\">\n                <div class=\"pic\">\n                  <img :src=\"food.image\">\n                </div>\n                <div class=\"content\">\n                  <h2 class=\"name\">{{ food.name }}</h2>\n                  <p class=\"desc\">{{ food.description }}</p>\n                  <div class=\"extra\">\n                    <span class=\"count\">月售{{ food.sellCount }}份</span>\n                    <span>好评率{{ food.rating }}%</span>\n                  </div>\n                  <div class=\"price\">\n                    <div class=\"price-context\">\n                      <span class=\"now\">￥{{ food.price }}</span>\n                      <span class=\"old\" v-show=\"food.oldPrice\">￥{{ food.oldPrice }}</span>\n                    </div>\n                    <div class=\"cart-context\">\n                      <i class=\"iconfont icon-jianshao\" v-show=\"cartCount > 0\"  @click=\"jianFood(index1,index2)\"></i>\n                      <span class=\"cart-count\" v-show=\"cartCount[index1] && cartCount[index1]> 0\">{{ cartCount[index1] }}</span>\n                      <i class=\"iconfont icon-jia\" @click=\"addFood(index1,index2)\"></i>\n                    </div>\n                  </div>\n                  <!-- + -->\n\n                </div>\n              </li>\n            </ul>\n          </li>\n        </ul>\n      </div>\n    </div>\n    \n    <Cart/>\n  </div>\n</template>\n\n<script>\nimport { getGoods } from '@/api'\nimport SupportIcon from '@/components/support-icon/Support-icon.vue'\nimport BScroll from '@better-scroll/core'\nimport Cart from '@/components/cart/Cart.vue'\nexport default {\n  components: {\n    SupportIcon,\n    Cart\n  },\n  data() {\n    return {\n      goods: [],\n      currentIndex: 0,\n      foodList:[],//各菜系的食物dom结构\n      foodBScroll:[],\n      scrollY:0,\n      foodHeight:[],\n      cartCount:[],\n    }\n  },\n  created() {\n    // 获取商品数据\n    getGoods().then(res => {\n      console.log(res);\n      this.goods = res\n      \n      this.$nextTick(() => { // $nextTick里面的回调会在页面加载完毕之后才执行\n        this.betterScroll()\n        this.getFoodHeight()\n        this.goods.forEach((item,index)=>{\n          console.log(item,index);\n        })\n      })\n    })\n  },\n  methods: {\n    betterScroll() {\n      // 获取到menu-wrapper的dom结构\n      new BScroll(this.$refs.menuWrapper, {\n        click: true\n      })\n      this.foodBScroll = new BScroll(this.$refs.foodsWrapper, {\n        click: true,\n        scroll: true,\n        probeType:3\n      })\n      this.foodList = this.$refs.foodList\n      this.foodBScroll.on('scroll',(pos)=>{\n        this.scrollY = Math.round(Math.abs(pos.y))\n      })\n    },\n    selectMenu(i) {\n      // console.log(i);\n      this.currentIndex = i\n      this.foodBScroll.scrollToElement(this.foodList[i],500)\n    },\n    selectFood(i,y) {\n      console.log(i,y);\n    },\n    getFoodHeight(){\n      let height = 0\n      this.foodHeight.push(height)\n      this.foodList.forEach((foodheight)=>{\n        height += foodheight.clientHeight\n        this.foodHeight.push(height)\n      })\n    }\n  },\n  // computed:{\n  //   computeHeight(){\n  //     const \n  //   }\n  // }\n}\n</script>\n\n<style lang=\"less\" scoped>\n@import '@/common/style/variable.less';\n.goods{\n  position: absolute;\n  width: 100%;\n  bottom: 46px;\n  top: 177px;\n  overflow: hidden;\n  &-content{\n    display: flex;\n    height: 100%;\n    .menu-wrapper{\n      flex: 0 0 80px;\n      background: @color-background-ssss;\n      .menu-item{\n        padding: 0 14px;\n        font-size: @fontsize-small;\n        height: 54px;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        &.current{\n          background: #fff;\n          font-weight: 700;\n        }\n      }\n    }\n    .foods-wrapper{\n      flex: 1;\n      .title{\n        height: 26px;\n        line-height: 26px;\n        font-size: @fontsize-small;\n        color: rgb(147, 153, 159);\n        background: @color-background-ssss;\n        padding-left: 14px;\n        border-left: 2px solid #d9dde1;\n      }\n      .food-item{\n        display: flex;\n        padding-bottom: 18px;\n        margin: 18px;\n        .pic{\n          flex: 0 0 57px;\n          margin-right: 10px;\n          img{\n            width: 100%;\n          }\n        }\n        .content{\n          flex: 1;\n          .name{\n            font-size: @fontsize-medium;\n            color: rgb(7, 17, 27);\n            margin: 2px 0 8px 0;\n          }\n          .desc, .extra{\n            font-size: @fontsize-small-s;\n            color: rgb(147, 153, 159);\n            margin-bottom: 8px;\n            line-height: 10px;\n            .count{\n              margin-right: 12px;\n            }\n          }\n          .extra{\n            margin-bottom: 0px;\n            }\n          .price{\n            display: flex;\n            font-weight: 700;\n            line-height: 24px;\n            height: 24px;\n            justify-content: space-between;\n            // align-items: center;\n\n            .price-context{\n              .now{\n              font-size: @fontsize-medium;\n              color: @color-red;\n              margin-right: 8px;\n            }\n            .old{\n              font-size: @fontsize-small-s;\n              color: rgb(147, 153, 159);\n              text-decoration: line-through;\n            }\n            }\n           \n            .cart-context{\n            margin-top: -2px;\n              .iconfont{\n              color: #00a0dc;\n              font-size: 22px;\n              padding: 6px;\n              vertical-align: middle;\n            }\n            .cart-count{\n              display: inline-block;\n              color: #8e8e8e;\n              font-size: 10px;\n              width: 12px;\n              text-align: center;\n            }\n            }\n            \n          }\n        }\n      }\n    }\n  }\n}\n</style>"],"mappings":";;;;AA+DA,SAASA,QAAO,QAAS,OAAM;AAC/B,OAAOC,WAAU,MAAO,4CAA2C;AACnE,OAAOC,OAAM,MAAO,qBAAoB;AACxC,OAAOC,IAAG,MAAO,4BAA2B;AAC5C,eAAe;EACbC,UAAU,EAAE;IACVH,WAAW,EAAXA,WAAW;IACXE,IAAG,EAAHA;EACF,CAAC;EACDE,IAAI,WAAAA,KAAA,EAAG;IACL,OAAO;MACLC,KAAK,EAAE,EAAE;MACTC,YAAY,EAAE,CAAC;MACfC,QAAQ,EAAC,EAAE;MAAC;MACZC,WAAW,EAAC,EAAE;MACdC,OAAO,EAAC,CAAC;MACTC,UAAU,EAAC,EAAE;MACbC,SAAS,EAAC;IACZ;EACF,CAAC;EACDC,OAAO,WAAAA,QAAA,EAAG;IAAA,IAAAC,KAAA;IACR;IACAd,QAAQ,CAAC,CAAC,CAACe,IAAI,CAAC,UAAAC,GAAE,EAAK;MACrBC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC;MAChBF,KAAI,CAACR,KAAI,GAAIU,GAAE;MAEfF,KAAI,CAACK,SAAS,CAAC,YAAM;QAAE;QACrBL,KAAI,CAACM,YAAY,CAAC;QAClBN,KAAI,CAACO,aAAa,CAAC;QACnBP,KAAI,CAACR,KAAK,CAACgB,OAAO,CAAC,UAACC,IAAI,EAACC,KAAK,EAAG;UAC/BP,OAAO,CAACC,GAAG,CAACK,IAAI,EAACC,KAAK,CAAC;QACzB,CAAC;MACH,CAAC;IACH,CAAC;EACH,CAAC;EACDC,OAAO,EAAE;IACPL,YAAY,WAAAA,aAAA,EAAG;MAAA,IAAAM,MAAA;MACb;MACA,IAAIxB,OAAO,CAAC,IAAI,CAACyB,KAAK,CAACC,WAAW,EAAE;QAClCC,KAAK,EAAE;MACT,CAAC;MACD,IAAI,CAACpB,WAAU,GAAI,IAAIP,OAAO,CAAC,IAAI,CAACyB,KAAK,CAACG,YAAY,EAAE;QACtDD,KAAK,EAAE,IAAI;QACXE,MAAM,EAAE,IAAI;QACZC,SAAS,EAAC;MACZ,CAAC;MACD,IAAI,CAACxB,QAAO,GAAI,IAAI,CAACmB,KAAK,CAACnB,QAAO;MAClC,IAAI,CAACC,WAAW,CAACwB,EAAE,CAAC,QAAQ,EAAC,UAACC,GAAG,EAAG;QAClCR,MAAI,CAAChB,OAAM,GAAIyB,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,GAAG,CAACH,GAAG,CAACI,CAAC,CAAC;MAC3C,CAAC;IACH,CAAC;IACDC,UAAU,WAAAA,WAACC,CAAC,EAAE;MACZ;MACA,IAAI,CAACjC,YAAW,GAAIiC,CAAA;MACpB,IAAI,CAAC/B,WAAW,CAACgC,eAAe,CAAC,IAAI,CAACjC,QAAQ,CAACgC,CAAC,CAAC,EAAC,GAAG;IACvD,CAAC;IACDE,UAAU,WAAAA,WAACF,CAAC,EAACF,CAAC,EAAE;MACdrB,OAAO,CAACC,GAAG,CAACsB,CAAC,EAACF,CAAC,CAAC;IAClB,CAAC;IACDjB,aAAa,WAAAA,cAAA,EAAE;MAAA,IAAAsB,MAAA;MACb,IAAIC,MAAK,GAAI;MACb,IAAI,CAACjC,UAAU,CAACkC,IAAI,CAACD,MAAM;MAC3B,IAAI,CAACpC,QAAQ,CAACc,OAAO,CAAC,UAACwB,UAAU,EAAG;QAClCF,MAAK,IAAKE,UAAU,CAACC,YAAW;QAChCJ,MAAI,CAAChC,UAAU,CAACkC,IAAI,CAACD,MAAM;MAC7B,CAAC;IACH;EACF;EACA;EACA;EACA;EACA;EACA;AACF"},"metadata":{},"sourceType":"module","externalDependencies":[]}