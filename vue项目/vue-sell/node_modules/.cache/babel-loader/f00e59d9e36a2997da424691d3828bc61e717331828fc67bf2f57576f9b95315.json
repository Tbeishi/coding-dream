{"ast":null,"code":"import \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.parse-int.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array.join.js\";\nimport { createNamespace } from '../../utils';\nimport { LIMIT_TYPE } from '../constants';\nimport Stepper from '../../stepper';\nvar namespace = createNamespace('sku-stepper');\nvar createComponent = namespace[0];\nvar t = namespace[2];\nvar QUOTA_LIMIT = LIMIT_TYPE.QUOTA_LIMIT,\n  STOCK_LIMIT = LIMIT_TYPE.STOCK_LIMIT;\nexport default createComponent({\n  props: {\n    stock: Number,\n    skuEventBus: Object,\n    skuStockNum: Number,\n    selectedNum: Number,\n    stepperTitle: String,\n    disableStepperInput: Boolean,\n    customStepperConfig: Object,\n    hideQuotaText: Boolean,\n    quota: {\n      type: Number,\n      \"default\": 0\n    },\n    quotaUsed: {\n      type: Number,\n      \"default\": 0\n    },\n    startSaleNum: {\n      type: Number,\n      \"default\": 1\n    }\n  },\n  data: function data() {\n    return {\n      currentNum: this.selectedNum,\n      // 购买限制类型: 限购/库存\n      limitType: STOCK_LIMIT\n    };\n  },\n  watch: {\n    currentNum: function currentNum(num) {\n      var intValue = parseInt(num, 10);\n      if (intValue >= this.stepperMinLimit && intValue <= this.stepperLimit) {\n        this.skuEventBus.$emit('sku:numChange', intValue);\n      }\n    },\n    stepperLimit: function stepperLimit(limit) {\n      if (limit < this.currentNum && this.stepperMinLimit <= limit) {\n        this.currentNum = limit;\n      }\n      this.checkState(this.stepperMinLimit, limit);\n    },\n    stepperMinLimit: function stepperMinLimit(start) {\n      if (start > this.currentNum || start > this.stepperLimit) {\n        this.currentNum = start;\n      }\n      this.checkState(start, this.stepperLimit);\n    }\n  },\n  computed: {\n    stepperLimit: function stepperLimit() {\n      var quotaLimit = this.quota - this.quotaUsed;\n      var limit; // 无限购时直接取库存，有限购时取限购数和库存数中小的那个\n\n      if (this.quota > 0 && quotaLimit <= this.stock) {\n        // 修正负的limit\n        limit = quotaLimit < 0 ? 0 : quotaLimit;\n        this.limitType = QUOTA_LIMIT;\n      } else {\n        limit = this.stock;\n        this.limitType = STOCK_LIMIT;\n      }\n      return limit;\n    },\n    stepperMinLimit: function stepperMinLimit() {\n      return this.startSaleNum < 1 ? 1 : this.startSaleNum;\n    },\n    quotaText: function quotaText() {\n      var _this$customStepperCo = this.customStepperConfig,\n        quotaText = _this$customStepperCo.quotaText,\n        hideQuotaText = _this$customStepperCo.hideQuotaText;\n      if (hideQuotaText) return '';\n      var text = '';\n      if (quotaText) {\n        text = quotaText;\n      } else {\n        var textArr = [];\n        if (this.startSaleNum > 1) {\n          textArr.push(t('quotaStart', this.startSaleNum));\n        }\n        if (this.quota > 0) {\n          textArr.push(t('quotaLimit', this.quota));\n        }\n        text = textArr.join(t('comma'));\n      }\n      return text;\n    }\n  },\n  created: function created() {\n    this.checkState(this.stepperMinLimit, this.stepperLimit);\n  },\n  methods: {\n    setCurrentNum: function setCurrentNum(num) {\n      this.currentNum = num;\n      this.checkState(this.stepperMinLimit, this.stepperLimit);\n    },\n    onOverLimit: function onOverLimit(action) {\n      this.skuEventBus.$emit('sku:overLimit', {\n        action: action,\n        limitType: this.limitType,\n        quota: this.quota,\n        quotaUsed: this.quotaUsed,\n        startSaleNum: this.startSaleNum\n      });\n    },\n    onChange: function onChange(currentValue) {\n      var intValue = parseInt(currentValue, 10);\n      var handleStepperChange = this.customStepperConfig.handleStepperChange;\n      handleStepperChange && handleStepperChange(intValue);\n      this.$emit('change', intValue);\n    },\n    checkState: function checkState(min, max) {\n      // 如果选择小于起售，则强制变为起售\n      if (this.currentNum < min || min > max) {\n        this.currentNum = min;\n      } else if (this.currentNum > max) {\n        // 当前选择数量大于最大可选时，需要重置已选数量\n        this.currentNum = max;\n      }\n      this.skuEventBus.$emit('sku:stepperState', {\n        valid: min <= max,\n        min: min,\n        max: max,\n        limitType: this.limitType,\n        quota: this.quota,\n        quotaUsed: this.quotaUsed,\n        startSaleNum: this.startSaleNum\n      });\n    }\n  },\n  render: function render() {\n    var _this = this;\n    var h = arguments[0];\n    return h(\"div\", {\n      \"class\": \"van-sku-stepper-stock\"\n    }, [h(\"div\", {\n      \"class\": \"van-sku__stepper-title\"\n    }, [this.stepperTitle || t('num')]), h(Stepper, {\n      \"attrs\": {\n        \"integer\": true,\n        \"min\": this.stepperMinLimit,\n        \"max\": this.stepperLimit,\n        \"disableInput\": this.disableStepperInput\n      },\n      \"class\": \"van-sku__stepper\",\n      \"on\": {\n        \"overlimit\": this.onOverLimit,\n        \"change\": this.onChange\n      },\n      \"model\": {\n        value: _this.currentNum,\n        callback: function callback($$v) {\n          _this.currentNum = $$v;\n        }\n      }\n    }), !this.hideQuotaText && this.quotaText && h(\"span\", {\n      \"class\": \"van-sku__stepper-quota\"\n    }, [\"(\", this.quotaText, \")\"])]);\n  }\n});","map":{"version":3,"names":["createNamespace","LIMIT_TYPE","Stepper","namespace","createComponent","t","QUOTA_LIMIT","STOCK_LIMIT","props","stock","Number","skuEventBus","Object","skuStockNum","selectedNum","stepperTitle","String","disableStepperInput","Boolean","customStepperConfig","hideQuotaText","quota","type","quotaUsed","startSaleNum","data","currentNum","limitType","watch","num","intValue","parseInt","stepperMinLimit","stepperLimit","$emit","limit","checkState","start","computed","quotaLimit","quotaText","_this$customStepperCo","text","textArr","push","join","created","methods","setCurrentNum","onOverLimit","action","onChange","currentValue","handleStepperChange","min","max","valid","render","_this","h","arguments","value","callback","$$v"],"sources":["C:/Users/方鹏/Desktop/codingSpace/vue项目/vue-sell/node_modules/vant/es/sku/components/SkuStepper.js"],"sourcesContent":["import { createNamespace } from '../../utils';\nimport { LIMIT_TYPE } from '../constants';\nimport Stepper from '../../stepper';\nvar namespace = createNamespace('sku-stepper');\nvar createComponent = namespace[0];\nvar t = namespace[2];\nvar QUOTA_LIMIT = LIMIT_TYPE.QUOTA_LIMIT,\n    STOCK_LIMIT = LIMIT_TYPE.STOCK_LIMIT;\nexport default createComponent({\n  props: {\n    stock: Number,\n    skuEventBus: Object,\n    skuStockNum: Number,\n    selectedNum: Number,\n    stepperTitle: String,\n    disableStepperInput: Boolean,\n    customStepperConfig: Object,\n    hideQuotaText: Boolean,\n    quota: {\n      type: Number,\n      default: 0\n    },\n    quotaUsed: {\n      type: Number,\n      default: 0\n    },\n    startSaleNum: {\n      type: Number,\n      default: 1\n    }\n  },\n  data: function data() {\n    return {\n      currentNum: this.selectedNum,\n      // 购买限制类型: 限购/库存\n      limitType: STOCK_LIMIT\n    };\n  },\n  watch: {\n    currentNum: function currentNum(num) {\n      var intValue = parseInt(num, 10);\n\n      if (intValue >= this.stepperMinLimit && intValue <= this.stepperLimit) {\n        this.skuEventBus.$emit('sku:numChange', intValue);\n      }\n    },\n    stepperLimit: function stepperLimit(limit) {\n      if (limit < this.currentNum && this.stepperMinLimit <= limit) {\n        this.currentNum = limit;\n      }\n\n      this.checkState(this.stepperMinLimit, limit);\n    },\n    stepperMinLimit: function stepperMinLimit(start) {\n      if (start > this.currentNum || start > this.stepperLimit) {\n        this.currentNum = start;\n      }\n\n      this.checkState(start, this.stepperLimit);\n    }\n  },\n  computed: {\n    stepperLimit: function stepperLimit() {\n      var quotaLimit = this.quota - this.quotaUsed;\n      var limit; // 无限购时直接取库存，有限购时取限购数和库存数中小的那个\n\n      if (this.quota > 0 && quotaLimit <= this.stock) {\n        // 修正负的limit\n        limit = quotaLimit < 0 ? 0 : quotaLimit;\n        this.limitType = QUOTA_LIMIT;\n      } else {\n        limit = this.stock;\n        this.limitType = STOCK_LIMIT;\n      }\n\n      return limit;\n    },\n    stepperMinLimit: function stepperMinLimit() {\n      return this.startSaleNum < 1 ? 1 : this.startSaleNum;\n    },\n    quotaText: function quotaText() {\n      var _this$customStepperCo = this.customStepperConfig,\n          quotaText = _this$customStepperCo.quotaText,\n          hideQuotaText = _this$customStepperCo.hideQuotaText;\n      if (hideQuotaText) return '';\n      var text = '';\n\n      if (quotaText) {\n        text = quotaText;\n      } else {\n        var textArr = [];\n\n        if (this.startSaleNum > 1) {\n          textArr.push(t('quotaStart', this.startSaleNum));\n        }\n\n        if (this.quota > 0) {\n          textArr.push(t('quotaLimit', this.quota));\n        }\n\n        text = textArr.join(t('comma'));\n      }\n\n      return text;\n    }\n  },\n  created: function created() {\n    this.checkState(this.stepperMinLimit, this.stepperLimit);\n  },\n  methods: {\n    setCurrentNum: function setCurrentNum(num) {\n      this.currentNum = num;\n      this.checkState(this.stepperMinLimit, this.stepperLimit);\n    },\n    onOverLimit: function onOverLimit(action) {\n      this.skuEventBus.$emit('sku:overLimit', {\n        action: action,\n        limitType: this.limitType,\n        quota: this.quota,\n        quotaUsed: this.quotaUsed,\n        startSaleNum: this.startSaleNum\n      });\n    },\n    onChange: function onChange(currentValue) {\n      var intValue = parseInt(currentValue, 10);\n      var handleStepperChange = this.customStepperConfig.handleStepperChange;\n      handleStepperChange && handleStepperChange(intValue);\n      this.$emit('change', intValue);\n    },\n    checkState: function checkState(min, max) {\n      // 如果选择小于起售，则强制变为起售\n      if (this.currentNum < min || min > max) {\n        this.currentNum = min;\n      } else if (this.currentNum > max) {\n        // 当前选择数量大于最大可选时，需要重置已选数量\n        this.currentNum = max;\n      }\n\n      this.skuEventBus.$emit('sku:stepperState', {\n        valid: min <= max,\n        min: min,\n        max: max,\n        limitType: this.limitType,\n        quota: this.quota,\n        quotaUsed: this.quotaUsed,\n        startSaleNum: this.startSaleNum\n      });\n    }\n  },\n  render: function render() {\n    var _this = this;\n\n    var h = arguments[0];\n    return h(\"div\", {\n      \"class\": \"van-sku-stepper-stock\"\n    }, [h(\"div\", {\n      \"class\": \"van-sku__stepper-title\"\n    }, [this.stepperTitle || t('num')]), h(Stepper, {\n      \"attrs\": {\n        \"integer\": true,\n        \"min\": this.stepperMinLimit,\n        \"max\": this.stepperLimit,\n        \"disableInput\": this.disableStepperInput\n      },\n      \"class\": \"van-sku__stepper\",\n      \"on\": {\n        \"overlimit\": this.onOverLimit,\n        \"change\": this.onChange\n      },\n      \"model\": {\n        value: _this.currentNum,\n        callback: function callback($$v) {\n          _this.currentNum = $$v;\n        }\n      }\n    }), !this.hideQuotaText && this.quotaText && h(\"span\", {\n      \"class\": \"van-sku__stepper-quota\"\n    }, [\"(\", this.quotaText, \")\"])]);\n  }\n});"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}